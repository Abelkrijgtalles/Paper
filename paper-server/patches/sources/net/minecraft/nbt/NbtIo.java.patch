From 6a0255d07a09045c7b0d3db3fa88ccfd06092226 Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 14:37:42 +0100
Subject: [PATCH] paper File Patches


diff --git a/net/minecraft/nbt/NbtIo.java b/net/minecraft/nbt/NbtIo.java
index 3451804eaeccd6c30e9f787c74f88fc3efbe819f..0288c323f273f943bb890a985e590ea9b24bf7eb 100644
--- a/net/minecraft/nbt/NbtIo.java
+++ b/net/minecraft/nbt/NbtIo.java
@@ -119,6 +119,11 @@ public class NbtIo {
     }
 
     public static CompoundTag read(DataInput input, NbtAccounter accounter) throws IOException {
+        // Spigot start
+        if (input instanceof io.netty.buffer.ByteBufInputStream byteBufInputStream) {
+            input = new DataInputStream(new org.spigotmc.LimitStream(byteBufInputStream, accounter));
+        }
+        // Spigot end
         Tag unnamedTag = readUnnamedTag(input, accounter);
         if (unnamedTag instanceof CompoundTag) {
             return (CompoundTag)unnamedTag;
