From 3aeeaf31b7a7f888f54e47826e8ec0ddbe65c4bf Mon Sep 17 00:00:00 2001
From: File <noreply+automated@papermc.io>
Date: Sun, 20 Apr 1997 14:37:42 +0100
Subject: [PATCH] paper File Patches


diff --git a/com/mojang/authlib/yggdrasil/YggdrasilGameProfileRepository.java b/com/mojang/authlib/yggdrasil/YggdrasilGameProfileRepository.java
index b87546f0061458b2b919a1fe00dde1f4eea6cb3e..55dac5edf694b3bf82b475a71e3524a1bce98882 100644
--- a/com/mojang/authlib/yggdrasil/YggdrasilGameProfileRepository.java
+++ b/com/mojang/authlib/yggdrasil/YggdrasilGameProfileRepository.java
@@ -44,6 +44,7 @@ public class YggdrasilGameProfileRepository implements GameProfileRepository {
             .collect(Collectors.toSet());
 
         final int page = 0;
+        boolean hasRequested = false; // Paper - Don't sleep after profile lookups if not needed
 
         for (final List<String> request : Iterables.partition(criteria, ENTRIES_PER_PAGE)) {
             final List<String> normalizedRequest = request.stream().map(YggdrasilGameProfileRepository::normalizeName).toList();
@@ -75,6 +76,12 @@ public class YggdrasilGameProfileRepository implements GameProfileRepository {
                         LOGGER.debug("Couldn't find profile {}", name);
                         callback.onProfileLookupFailed(name, new ProfileNotFoundException("Server did not find the requested profile"));
                     }
+                    // Paper start - Don't sleep after profile lookups if not needed
+                    if (!hasRequested) {
+                        hasRequested = true;
+                        continue;
+                    }
+                    // Paper end - Don't sleep after profile lookups if not needed
 
                     try {
                         Thread.sleep(DELAY_BETWEEN_PAGES);
